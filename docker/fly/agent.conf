agent {
    data_dir = "/opt/spire/data/agent"
    log_level = "INFO"
    
    # Connect to SPIRE Server via Fly private network
    # The server address is set via environment variable at runtime
    server_address = "SPIRE_SERVER_PLACEHOLDER"
    server_port = "8081"
    
    # Trust bundle will be fetched from server on first connection
    insecure_bootstrap = true
    
    trust_domain = "protocolsoup.com"
    
    # Local workload API socket
    socket_path = "/run/spire/sockets/agent.sock"
}

plugins {
    NodeAttestor "join_token" {}
    
    KeyManager "disk" {
        plugin_data {
            directory = "/opt/spire/data/agent"
        }
    }
    
    WorkloadAttestor "unix" {
        plugin_data {}
    }
}

